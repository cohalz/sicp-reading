# 例:素数判定

整数nが素数であるかの判定を行う.

扱う判定法は2つであり,
増加のオーダが O(√n)のものと,
O(log n)のものを扱う.

## 約数を探す方法

### 方法

2以上の数で割っていき,
最終的に割れなかったものは素数でしょ,
という考え.

### Schemeによる実装

```scheme
; 最小の約数を求める関数
(define (smallest-divisor n) (find-divisor n 2))

; 約数を見つける関数
(define (find-divisor n test-divisor)
  ; test-divisorの2乗がnより大きい時,nを返す.
  (cond ((> (square test-divisor) n) n)
        ; test-divisorがnで割り切れたら,test-divisorを返す.
        ((divides? test-divisor n) test-divisor)
        ; それ以外の場合test-divisorの値を+1して再度判定を行う.
        (else (find-divisor n (+ test-divisor 1)))))

;わり切れるかの判定をする関数
(difine (divides? a b) (= (remainder b a) 0))

```

上記を予め定義しておく.これにより以下を定義する.

```scheme
; 素数であるかを判定する関数.
(difine (prime? n)
  (= n (smallest-divisor n)))

```

この場合1から√nまでの約数についてのみ判定すればよいので,
オーダーはO(√n)となる.

(※nが素数でなければ,
nの約数の数は√nより小さい,
または等しいという原理があるから)

## フェルマーテスト

フェルマーの小定理を利用したもの.

### フェルマーの小定理

nが素数とする時任意の自然数aに対して以下が成り立つ.

```math
n^a \equiv a \pmod{a}
```
